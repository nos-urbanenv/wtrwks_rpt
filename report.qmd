---
title: "浄水処理実験 実験レポート"
author: "03250114 大隅伸明"
format:
  markdown_github: default
  pdf:
    pdf-engine: lualatex
    documentclass: ltjsarticle
    classoption: [10pt]
editor: visual
---

```{r}
#| include: false
#| echo: false
library(dplyr)
library(gt)
library(ggplot2)
```

<!--# ここに表紙用のraw latexコード -->

## 目的

上水実験課題では以下の項目を扱い、浄水処理の物理化学的な原理について定性的・定量的な両面から理解を深めることを目的とする。

1.  オゾンによる有機物分解

2.  a

3.  a

4.  凝集沈殿における最適条件の決定

5.  消毒

    1.  塩素消毒

    2.  紫外線消毒

## 課題A オゾンによる有機物分解

### 実験概要

概要をここに書いていく。。

### 結果

```{r}
#| echo: false
#| message: false
ozone <- read.csv("ozone.csv")
ozn_calib <- read.csv("ozone_calib.csv")
```

まず、メチレンブルー濃度算出に用いる検量線を作成した。各班の実測値は以下の通り。

```{r}
#| echo: false
ozn_calib %>% group_by(班) %>% gt()
```

<!--# ここの表現もうちょっと洗練させたいなぁ。。 -->

上記のデータを用いて最小二乗法で検量線を作成したところ、今回採用した希釈段階の全域に渡ってデータは線形な変化であることを確認することができた。

```{r}
#| echo: false
ozn_calib %>% 
  ggplot(mapping = aes(x=メチレンブルー濃度.mg.L., y=吸光度))+
  geom_point()+
  geom_smooth(method="lm")+
  theme_bw(axis.title=element_text(family="Hiragino Maru Gothic Pro"),
           title=element_text(family="Hiragino Maru Gothic Pro"),
           axis.text=element_text(family="Hiragino Maru Gothic Pro"))+
  facet_wrap(~班)
```

上記の検量線を用いて、各時刻でのメチレンブルー濃度の変化を導出した。pH・オゾン濃度・TOC濃度の実測値と合わせ、以下に結果を示す。

```{r}
#| echo: false
#検量線を用いて濃度を算出する。吸光度測定時の希釈倍率も考慮。
ozone <- ozone %>% 
  mutate(メチレンブルー濃度=吸光度*吸光度_希釈,
         TOC濃度 = NA)

#表示
ozone %>%
  select(-c("TOC_vial","TOC_filename")) %>% 
  group_by(班,条件) %>% gt()
```

吸光度の時間変化を図示すると以下のようになった。

```{r}
#| echo: false
ozone %>% select("時間.分.","メチレンブルー濃度","班") %>% 
  ggplot(mapping=aes(x=時間.分. ,y=メチレンブルー濃度)) +
  geom_point()+
  theme_bw(axis.title=element_text(family="Hiragino Maru Gothic Pro"),
           title=element_text(family="Hiragino Maru Gothic Pro"),
           axis.text=element_text(family="Hiragino Maru Gothic Pro"))+
  facet_wrap(~班)
```

### 考察

## 課題B

### 実験概要

### 結果

### 考察

## 課題C

### 実験概要

### 結果

### 考察

## 課題D 凝集沈殿における最適条件の決定

### 実験概要

概要をここに書く。

### 結果

まず、二種類の水試料について、凝集剤の濃度を変化させて凝集剤の最適添加量を求めた。実験結果は以下のようになった。

```{r}
#| echo: false
flc_amt <- read.csv("flc_amt.csv")
#ファクター指定(とりあえずテストのために1。実験日・実験グループごとに変える必要があるのでリストにする予定。)
factor = 1
#m-アルカリ度計算
flc_amt <- flc_amt %>% mutate(mアルカリ度 = (滴定_前 - 滴定_後) * factor) %>% 
  group_by(実験) %>% 
  select(-c("滴定_前", "滴定_後", "滴定試料量"))

flc_amt %>% gt()
```

<!--# 何アルカリ度だっけ? -->

また、m-アルカリ度

最適な凝集剤添加条件は以下のように求められた。

<!--# 全班一緒ならmax()で数値埋め込み。そうでなければ表を作る。 -->

次に、上記で求めた最適量の凝集剤を添加した上で、pHを酸性\~アルカリ性の数段階で変化場合の各化学指標の経時変化を以下に示す。

```{r}
#| echo: false
#factorは当然、凝集剤添加量決定時と同じものを使用する。
flc_ph <- read.csv("flc_ph.csv") %>% 
  mutate(mアルカリ度 = (滴定_前 - 滴定_後) * factor)

flc_ph %>% 
  group_by(試料) %>% 
  gt()
```

### 考察

考察をここに書く

## 課題E 消毒

### 実験概要

### 結果

### 考察
